Low Cost Indoor Positioning System⋆
Cliff Randell

Henk Muller

Department of Computer Science, University of Bristol, UK.

Abstract. This report describes a low cost indoor position sensing system utilising a combination of radio frequency and ultrasonics. Using a
single rf transmitter and four ceiling mounted ultrasonic transmitters it
provides coverage in a typical room in an area greater than 8m by 8m.
As well as finding position within a room, it uses data encoded into the
rf signal to determine the relevant web server for a building, and which
floor and room the user is in. It is intended to be used primarily by
wearable/mobile computers, though it has also been extended for use as
a tracking system.

1

Introduction and Background

There are three technologies commonly used for indoor location systems - ultrasonics, infrared and rf. These can be supplemented by inertial systems which
are generally used for prediction. Infrared systems tend to rely on the user
taking explicit actions to identify their presence [1] [2]; and rf-systems require
sophisticated (and often cumbersome) aerials [3] [4] - ultrasonics offer a low
cost solution which can operate without any user interaction. The disadvantages
of an ultrasonic system are loss of signal due to obstruction; false signals due
to reflections; and interference from high frequency sounds such as keys jangling, rustling paper etc. These disadvantages can be minimised and systems
produced by commercial suppliers such as Intersense [5] and AT&T [6] [7] have
successfully implemented ultrasonic positioning with impressive results. These
commercial systems are too expensive for use by the average researcher - typically costing over U.S.$15,000. The Cricket Location-Support System developed
by researchers at M.I.T. [8] provides low cost position estimation designed to
achieve portion-of-a-room granularity using a network of beacons. We describe a
simple system which can be implemented for around U.S.$150 and gives results
providing accuracies of 10-25cm.
It is intended that this design is used to complement external positioning
using GPS and hence provide results which have similar characteristics. For
example, a typical GPS application will detect position in a 1km x 1km city
centre to within 15m. We aim to be able to detect position in a 10m x 10m
room to within 15cm. This system does not provide the accuracies achieved by
commercial systems, nor does it provide continuous resolution between cells,
nevertheless this simple design is suitable for many research applications.
⋆

Funding for this work is received from the U.K. Engineering and Physical Sciences
Research Council, Grant No. 15986

2

Design

To determine position in a 3D space using trilateration we require three distance
measurements. In this system we use a rf signal - or ’ping’ - as a synchronising pulse followed by four precisely timed ultrasonic signals - or ’chirps’. This
arrangment allows the ’times-of-flight’ between the four separately located transmitting transucers and the receiver to be determined. These times-of-flight are
converted to distances by factoring them with the speed of sound. We use four
to increase the range of the system and to compensate for occasions when one
signal is lost - it also simplifies the geometric calculations.

Fig. 1. Timing diagram (not to scale).

The ping, containing an eight byte coded packet broadcast by a 418MHz
FM short range transmitter, ensures that the receiver is synchronised to the
transmitter. The packet consists of an identifier byte, an IP address, floor and
room number bytes and a spare byte which can be dynamically assignable to
assist with two way communication e.g. for a tracking system which requires each
new user entering the room to register with the system. The maximum range
of the ping is 100m, though this can be reduced to enable separate systems to
operate in adjacent rooms.
The chirps consist of 48 cycles - 1.2ms - of 40kHz generated by a PIC microcontroller and are transmitted sequentially at 50ms intervals as shown in Figure 1. We use 48 cycles as 1ms of signal is relatively easy to identify using simple
test equipment. Theoretically it should be possible to reduce this to 3 cycles.
Open face piezo transducers manufactured by Polaroid [9] have been selected
to give optimum results. These devices provide the widest possible transmission
angle combined with high output(tx)/high sensitivity(rx).
The four ultrasonic transmitters are mounted, facing vertically downwards,
on the ceiling of the room to be covered. They are placed at the corners of a
square and connected to the transmitter module which contains the ultrasonic
drivers, the microcontroller and rf transmitter. In our 4.2m x 6.5m test room we

have obtained satisfactory results using 2m, 3m, and 4m square configurations
with a ceiling height of 3.2m.
The receiver uses a matching rf receiver, decoder and PIC microcontroller.
A dual operational amplifier is used to provide additional control over how the
incoming ultrasonic signal is processed. These components are mounted in a
small module which is either attached to a palmtop or handheld computer with
a graphic display, or, in the case of a wearable, placed on the shoulder of the
user. A rechargeable PP3 9v battery can provide sufficient power for a full day’s
operation. A feature of this design is the potential for an unlimited number of
receivers to operate in the area covered.
We experimented with various ultrasonic receiver configurations and signal
processing techniques including envelope detection, bandpass filters and various
gain settings. We concluded that a single transducer with a simple high gain amplifier with high pass filtering is sufficient. Experiments with multiple receiving
transducers to provide omnidirectional reception were prone to picking up reflections; envelope detection introduced both delay and uncertainty; and bandpass
filters were unnecessary as the sensing device is highly resonant.
The PIC is programmed to measure the number of 100us delay units occuring
between transmission and reception of each chirp. These delay units correspond
to 3.4cm, giving an optimum resolution of 2.4cm at one and a half metres below
the centre of the transmitter square. The delay units are combined with the eight
bytes from the pinger and passed to a RS232 output.
Extensions to the basic design include using additional transducers for greater
coverage - a six transducer system has been successfully tested with transducers
placed 7m above the floor giving coverage over an area of 10m by 18m. Larger
configurations are feasible with the penalty of a slower response. An electronic
compass has also been successfully integrated to provide heading as well as position data and work is underway to include an accelerometer for tilt sensing.
A tracking system is under test using a 802.11 wireless network to send the
analysed data via the internet to remote locations (see Figure 3).

3
3.1

Results and Data Analysis
Results

The resulting raw data is illustrated as a histogram in Figure 2. This shows
100 error readings obtained when the receiver was placed at x=0, y=0, and 2m
below the ceiling. The maximum error is 10cm - this is an optimal result with
accuracy degrading to around 25cm around the perimeter of the test room.
As we are detecting the first cycle of each chirp, and are not interested in
the envelope of the signal, reflections are not relevant - except when the direct
signal is blocked. This can be a problem when the user is close to, and facing,
a wall resulting in the apparent position being on the other side of the wall.
Obstruction of the chirps is the main cause of failure of the system. While only
three of the four chirps are required, and this situation frequently arises when the

35

30

25

Number

20

15

10

5

0

0

20

40

60
Distance (mm)

80

100

120

Fig. 2. Errors at x=0,y=0.

user is directly between a transmitter and receiver, the problem only becomes
serious when a number of people crowd around the receiver. The system is also
affected by high level environmental ultrasonic noise, however in practice these
sounds are usually short lived.
3.2

Data Analysis

Post processing of the time-of-flight data is carried out in the host computer in our experiments we have employed Windows CE based devices (H-P Jornada
palmtops and handhelds). This configuration enables the use of simple algorithms, as well as trilateration, to resolve the precise position of the user from
the raw data. The primary techniques which have been found to be effective
are:• Best Signal Selection - Initially, where more than three good signals were
received, the results were averaged. This retained the poorest quality signal
but made use of all the data available. An improved result was obtained
by selecting the three shortest time-of-flight paths and using these for the
position calculation.
• Non-Incident Angle Compensation - The most accurate results are obtained when the transmitting and receiving transducers are incident. A formula has been derived by experiment to compensate for non-incident reception.
• Threshold Filtering - the cursor indicating current position on a graphic
display suffered from jitter. This effect was eliminated by the introduction
of a threshold over which a change in x or y position had to exceed.
• Speed Limit - occasional spurious readings which indicate large changes in
position can be identified and filtered by imposing a ’speed limit’. This is in

two stages. The first stage simply limits movements to a maximum of 1 m/s.
The second stage rejects any reading which indicates a movement exceeding
2 m/s.
• 2D Estimation - where only two paths can be measured it is still possible
to calculate a x,y position if the z co-ordinate (height) is estimated e.g. at
waist level. In this case there are two possible x,y solutions, however only one
of these solutions will apply in locations where there are only two received
signals. Use of this algorithm extends the area covered to well beyond the
area directly beneath the ultrasonic transducers.
• Averaging - The final readings used for the application interface takes the
average of the current reading and the previous reading. This is effective in
reducing errors and provides a smoother trajectory when moving across a
room. The disadvantage is the inherent delay in this approach. This delay is
less than 500ms and was considered acceptable.
The value of these algorithms varied according to the application. For example, if the speed limit was set at a low value e.g. 0.5m/s, feedback to the user
using a graphic map display was considered to suffer from unacceptable lag. On
the other hand the smoothing effect of a low speed limit for a remote viewer was
found to make the tracking more acceptable.

4

Applications

Our first application has been designed to test and demonstrate the potential of
the system. We have previously built a tourist application for use outdoors [10].
This application automatically renders web pages on a palmtop display when a
visitor reaches a place of interest whose co-ordinates match the current position
as determined by a GPS receiver. To test our indoor location system we are
using an equivalent application which provides web pages related to objects in a
room e.g. a computer terminal has a web page which gives it’s name, associated
administrator, printer and IP address. In practice this worked well enabling users
to seek out and discover hidden information in the test room.
User tests were also carried out during a workshop linking a ’real’ room
with a Reactor (a CAVE like device [11]) in which a model of the room was
projected. The user in the room was tracked using the receiver attached to a
handheld device - see Figure 3 - and appeared as an avatar in the Reactor.
The participants successfully explored the room - in reality and in the model
- relating to the relative positions of each other and the objects in the room.
Satisfaction with the x/y tracking was reported, however users in the Reactor
commented on the avatar ’jumping’ as a result of instability in the z axis data.
Further systems are being installed as part of other projects associated with
the Equator EPSRC Project [12]. These projects aim to uncover and support
the possible relationships between the physical and digital worlds. They include
installations in a domestic setting to investigate models of spatial awareness and
service discovery; in a 10m by 30m atrium to facilitate the discovery of hidden

Fig. 3. The prototype receiver in use with a handheld computer.

worlds, and also to enable interaction with virtual performers; and for a user in
a museum to provide a shared experience to a remote companion.

5

Conclusion

We have designed and built an effective indoor positioning system using a minimal infrastructure and readily available components. This system is relatively
simple to install, requires no calibration after the initial installation, and has
a low price tag. Sample applications have been tested with subjective results
comparable to those obtained using GPS in an outdoor setting. The system can
easily be adapted to provide extended coverage, and it’s performance is suitable
for facilitating many different virtual and augmented reality research projects.

References
1. R. Want and A. Hopper. The active badge location system. In ACM Transactions
on Information Systems, pages 91–102, January 1992.
2. H-p cooltown home page. http://www.cooltown.com/.
3. F. Raab, E. Blood, T. Steiner, and T. Jones. Magnetic position and orientation
tracking system. In IEEE Transactions on Aerospace and Electronic Systems,
volume AES-15 no.5, pages 709–718, September 1979.
4. Polhemus home page. http://www.polhemus.com/.
5. Intersense home page. http://www.isense.com/.
6. A. Ward, A. Jones, and A. Hopper. A new location technique for the active office.
In IEEE Personal Communications Magazine, volume 4 no.5, pages 42–47, October
1997.

7. A. Harter, A. Hopper, P. Steggles, A. Ward, and P. Webster. The anatomy of a
context-aware application. In Proceedings of the Fifth Annual ACM/IEEE International Conference on Mobile Computing and Networking, pages 59–68, August
1999.
8. N. Priyantha, A. Chakraborty, and H. Balakrishnan. The cricket location-support
system. In 6th ACM/IEEE International Conference on Mobile Computing and
Networking., August 2000.
9. Polaroid home page. http://www.polaroid-oem.com/.
10. C. Randell. Design and construction of wearable computers. In IEE Seminar Wearable Computing, pages 8/1–4. The Institution of Electrical Engineers, November 2000.
11. C. Cruz-Neira, D. Sandin, and T. DeFanti. Virtual reality: The design and implementation of the cave. In Proceedings of SIGGRAPH 93 Computer Graphics
Conference, pages 135–142, August 1993.
12. Equator home page. http://www.equator.ac.uk/.

